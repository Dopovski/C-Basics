#include <iostream>
#include <vector>
#include <string>
#include <cmath>

using namespace std;

vector<vector<int>> readMatrix(int n) {
    vector<vector<int>> matrix(n, vector<int>(n));
    for (int i = 0; i < n; i++) {
        for (int j = 0; j < n; j++) {
            cin >> matrix[i][j];
        }
    }
    return matrix;
}

void printMatrix(const vector<vector<int>>& matrix) {
    int n = matrix.size();
    cout << " ";
    for (int j = 0; j < n; j++) {
        cout << " " << char('A' + j);
    }
    cout << endl;

    for (int i = 0; i < n; i++) {
        cout << char('A' + i);
        for (int j = 0; j < n; j++) {
            cout << " " << matrix[i][j];
        }
        cout << endl;
    }
}

struct OptimizationResult {
    int totalOpportunities;
    int maxOp;
    vector<string> maxPairs;
};

OptimizationResult findOptimizations(const vector<vector<int>>& matrix) {
    int n = matrix.size();
    int totalOpportunities = 0;
    int maxOp = 0;
    vector<string> maxPairs;

    for (int i = 0; i < n; i++) {
        for (int j = i + 1; j < n; j++) {
            if (matrix[i][j] != matrix[j][i]) {
                int diff = abs(matrix[i][j] - matrix[j][i]);
                totalOpportunities += diff;

                cout << char('A'+i) << char('A'+j) << "(" << matrix[i][j] << ") - "
                     << char('A'+j) << char('A'+i) << "(" << matrix[j][i] << ")" << endl;

                if (diff > maxOp) {
                    maxOp = diff;
                    maxPairs.clear();
                    maxPairs.push_back(string(1,'A'+i) + string(1,'A'+j) + "-" + string(1,'A'+j) + string(1,'A'+i));
                } else if (diff == maxOp) {
                    maxPairs.push_back(string(1,'A'+i) + string(1,'A'+j) + "-" + string(1,'A'+j) + string(1,'A'+i));
                }
            }
        }
    }

    return {totalOpportunities, maxOp, maxPairs};
}

void printMaxOptimization(const OptimizationResult& res) {
    if (res.maxPairs.empty()) {
        cout << "Max optimization: none" << endl;
        return;
    }

    cout << "Max optimization: " << res.maxOp << ": ";

    for (int i = 0; i < res.maxPairs.size(); i++) {
        cout << res.maxPairs[i];
        if (i != res.maxPairs.size() - 1) {
            cout << " ";  
        }
    }
    cout << endl;
}



int main() {
    int n;
    cin >> n;

    vector<vector<int>> matrix = readMatrix(n);
    printMatrix(matrix);

    OptimizationResult res = findOptimizations(matrix);

    cout << "Total opportunities: " << res.totalOpportunities << endl;
    printMaxOptimization(res);

    return 0;
}
